anDanbury = {
  "Name" : "Tails of Courage",
  "Description" : "Dog walkers, foster homes, volunteers at shelters, volunteers for adoption events, spreading the word, clean up, transportation",
  "Address" : "39 Smith St, Danbury CT, 06810",
  "Link" : "https://tailsofcourage.org/fostervolunteering/"
};

var animals = {
    "Bridgeport" : "No responses matching search",
    "Danbury" : anDanbury,
    "Glastonbury" : "No responses matching search",
    "Greenwich" : "No responses matching search",
    "Hartford" : "No responses matching search",
    "Litchfield" : "No responses matching search",
    "Middletown" : "No responses matching search",
    "Haven" : "No responses matching search",
    "London" : "No responses matching search",
    "Norwalk" : "No responses matching search",
    "Stamford" : "No responses matching search",
    "Waterbury" : "No responses matching search"
};
/////////////////////////////////////////////////////////////////////////////////////
var pplBridgeport = {
  "Name" : "Daniel Trust Foundation",
  "Description" : "Invests in and supports low income students\' educational and professional goals",
  "Address" : "285 Fairfield Avenue, Bridgeport CT, 06604",
  "Link" : "https://www.danieltrustfoundation.org/"
};

var pplDanbury = {
  "Name" : "The Salvation Army Family Store and Donation Center",
  "Description" : "Help disaster survivors, cure hunger, overcome poverty, serve the LGBTQ community, provide shelter, fight human trafficking, stop domestic abuse, equip families, teach kids, empower the arts, assist the unemployed, combat addiction, love the elderly, serve veterans, share god\'s love, and meet the greatest need",
  "Address" : "129 Main St, Danbury CT, 06810",
  "Link" : "https://www.salvationarmyusa.org/usn/"
};
var pplGlastonbury = {
  "Name" : "Youth and Family Services",
  "Description" : "Glastonbury youth and family services is a town agency devoted to programs and services that respond to the needs of Glastonbury youth and their family",
  "Address" : "321 Hubbard Street, Glastonbury CT, 06033",
  "Link" : "http://www.glastonbury-ct.gov/departments/department-directory-l-z/youth-and-family-services#ad-image-2"
};
var ppl1Glastonbury = {
  "Name" : "Glastonbury Food Bank",
  "Description" : "Provide educational, creative, and social benefits for all children with particular reference to children with special needs",
  "Address" : "2155 Main St, Glastonbury CT",
  "Link" : "http://www.childrensworldcharity.org/"
};
var ppl2Glastonbury= {
  "Name" : "YMCA",
  "Address" : "95 Oakwood Drive, Glastonbury CT, 06033",
  "Description" : "You can help by choosing from the options of being a coach, volunteering, and doing community service",
  "Link" : "http://www.ghymca.org/index.cfm"
};
var ppl3Glastonbury = {
  "Name" : "Children\'s Advancement Fund",
  "Description" : "A nonprofit organization, supports children with special needs and their families in connecticut by facilitating services such as occupational, physical, and speech/language therapy",
  "Address" : "1062 Glastonbury CT 06033 USA ",
  "Link" : "https://www.facebook.com/childrensadvancementfund/"
};

var pplHartford = {
  "Name" : "Connecticut Children\'s Medical Center",
  "Description" : "Connecticut Children\'s Medical Center is dedicated to improving the physical and emotional health of children through family-centered care, research, education and advocacy. They embrace discovery, teamwork, integrity and excellence in all that we do. They are making children in Connecticut the healthiest in the country",
  "Address" : "282 Washington St, Hartford, CT 06106",
  "Link" : "https://www.connecticutchildrens.org/about-us/mission/"
};

var pplLitchfield = {
  "Name" : "North American Family Institute",
  "Description" : "North American Family Institute is a private, nonprofit human service agency specializing in community-based care for children, youth and adults with mental health and/or behavioral issues. Since 1974, we have provided programming and services designed around the Normative Community Approach, which emphasizes the ability of all people to achieve positive change when they are members of a community united in mission and purpose. Together, we empower individuals to maximize their independence and succeed in the future",
  "Address" : "11 Country Place, Litchfield, CT 06759",
  "Link" : "http://www.nafi.com/"
};


var pplMiddletown = {
  "Name" : "US Pain Foundation",
  "Description" : "Dear friend, If you love our work then tell the world! You have an opportunity to help us make even more of a difference in our community. GreatNonprofits-a review site like TripAdvisor-is honoring highly reviewed nonprofits with their 2013 Top-Rated Awards. Won\'t you help us raise visibility for our work by posting a review of your experience with us? All reviews will be visible to potential donors and volunteers. It\'s easy and only takes 3 minutes! ",
  "Address" : "670 Newfield street suite B, Middletown CT, 06457",
  "Link" : "https://uspainfoundation.org/"
};

var pplHaven = {
  "Name" : "Cents of Relief",
  "Description" : "This non-profit help people in vulnerable situations especially women in prostitution. They provide healthcare for their kids. They also help in the effort of stopping human trafficking",
  "Address" : "109 Church Street, Apt 202 New Haven CT 06510 USA",
  "Link" : "https://greatnonprofits.org/org/centsofrelief"
};
var pplLondon = {
  "Name" : "Birthright- Israel",
  "Description" : "Birthright guiding principle It is the right of every pregnant woman to give birth and the right of every child to be born. Birthright offers the alternative to abortion. Birthright is pro-life. Birthright is non-profit, interdenominational, and non-political. Help make a difference in a mother\'s life as she prepares for the birth of her baby",
  "Address" : "26 Phillips St, New London, CT 06901",
  "Link" : "https://www.birthrightisrael.com/"
};
var pplNorwalk = {
  "Name" : "Person 2 Person",
  "Description" : "Person 2 Person is an organization that helps to less fortunate. They have events such as food pantries,P2P on wheels, and food drive",
  "Address" : "76 S Main St, Norwalk, CT 06854",
  "Link" : "https://p2phelps.org/volunteers/#volunteer-programs"
};
var pplStamford = {
  "Name" : "SunRise Senior Living",
  "Description" : "A nursing home for the elderly and also a its a rehab center for the injured",
  "Address" : "251 Turn of River Road  Stamford  CT  06905",
  "Link" : "https://www.sunriseseniorliving.com/"
};
var ppl1Stamford = {
  "Name" : "At Risk Youth",
  "Description" : "Mentors needed to guide at risk youth",
  "Address" : "1 Hospital Plaza, Stamford, CT 06904 ",
  "Link" : "https://www.stamfordhealth.org/about/volunteering/"
};

var ppl2Stamford = {
  "Name" : "Birthright- Israel",
  "Description" : "Birthright guiding principle It is the right of every pregnant woman to give birth and the right of every child to be born. Birthright offers the alternative to abortion. Birthright is pro-life. Birthright is non-profit, interdenominational, and non-political. Help make a difference in a mother\'s life as she prepares for the birth of her baby",
  "Address" : "388 Summer St, Stamford, CT 06901",
  "Link" : "https://www.birthrightisrael.com/"
};
var pplWaterbury = {
  "Name" : "Connecticut Community Foundation",
  "Description" : "Building rewarding lives and thriving communities in Greater Waterbury and the Litchfield Hills",
  "Address" : "43 Field Street, Waterbury, CT 06702",
  "Link" : "https://conncf.org/"
};


var people = {
    "Bridgeport" : pplBridgeport,
    "Danbury" : pplDanbury,
    "Glastonbury" : [pplGlastonbury, ppl1Glastonbury, ppl2Glastonbury, ppl3Glastonbury],
    "Greenwich" : "No responses matching search",
    "Hartford" : pplHartford,
    "Litchfield" : pplLitchfield,
    "Middletown" : pplMiddletown,
    "Haven" : pplHaven,
    "London" : pplLondon,
    "Norwalk" : pplNorwalk,
    "Stamford" : [pplStamford, ppl1Stamford],
    "Waterbury" : pplWaterbury
};
////////////////////////////////////////////////////////////

var oneDanbury = {
  "Name" : "Tails of Courage",
  "Description" : "Dog walkers, foster homes, volunteers at shelters, volunteers for adoption events, spreading the word, clean up, transportation",
  "Address" : "39 Smith St, Danbury CT, 06810",
  "Link" : "https://tailsofcourage.org/fostervolunteering/"
};

var oneGlastonbury = {
  "Name" : "Glastonbury Food Bank",
  "Description" : "Provide educational, creative, and social benefits for all children with particular reference to children with special needs",
  "Address" : "2155 Main St, Glastonbury CT",
  "Link" : "http://www.childrensworldcharity.org/"
};

var oneLitchfield = {
  "Name" : "Litchfield Jazz Festival",
  "Description" : "Set in the picturesque, rolling Litchfield Hills, the Litchfield Jazz Festival was launched in 1996 with a line-up any well-established festival would be proud of today the up-and-coming Diana Krall, Christian McBride, Terence Blanchard, Russell Malone, Peter Bernstein, Larry Goldings, Renee Rosnes, Mark Turner and many more",
  "Address" : "P.O. Box 69, Litchfield, Connecticut 06759",
  "Link" : "https://litchfieldjazzfest.com/"
};
var oneWaterbury = {
  "Name" : "Waterbury Art Fest",
  "Description" : "The Waterbury Arts Fest is a two day street fair with entertainment and artwork from some the most talented performers and artists in our area! It also serves as the main fundraiser for Revitalizing Waterbury",
  "Address" : "23 Stowe St, Waterbury, CT 06702",
  "Link" : "https://waterburyartsfest.com/"
};

var oneday = {
    "Bridgeport" : "No responses matching search",
    "Danbury" : oneDanbury,
    "Glastonbury" : oneGlastonbury,
    "Greenwich" : "No responses matching search",
    "Hartford" : "No responses matching search",
    "Litchfield" : oneLitchfield,
    "Middletown" : "No responses matching search",
    "Haven" : "No responses matching search",
    "London" : "No responses matching search",
    "Norwalk" : "No responses matching search",
    "Stamford" : "No responses matching search",
    "Waterbury" : oneWaterbury
};

/////////////////////////////////////////////////////////////
var campBridgeport = {
  "Name" : "Daniel Trust Foundation",
  "Description" : "Invests in and supports the educational and professional goals of low income students",
  "Address" : "285 Fairfield Avenue, Bridgeport CT, 06604",
  "Link" : "https://www.danieltrustfoundation.org/"
};

var camp1Bridgeport = {
  "Name" : "Service For Peace Inc.",
  "Description" : "Volunteers participate in ongoing community development programs throughout the world",
  "Address" : "360 Fairfield Ave Ste 206, Bridgeport CT, 06604",
  "Link" : "http://www.serviceforpeace.org/"
};

var campHartford = {
  "Name" : "Girl Scouts",
  "Description" : "Provides girls with leadership skills and the confidence to take challenges head on and to let them know that woman have a place in this world also",
  "Address" : "340 Washington St, Hartford, CT 06106",
  "Link" : "https://www.girlscouts.org/en/adults/volunteer.html"
};

var campHaven = {
  "Name" : "Solar Youth",
  "Description" : "Solar Youth provides opportunities for young people to develop a positive sense of self and connection and commitment to others through programs that incorporate environmental exploration, leadership and community service",
  "Address" : "53 Wayfarer St New Haven CT 06515 USA",
  "Link" : "https://greatnonprofits.org/org/solar-youth-inc"
};

var campLondon = {
  "Name" : "Girl Scouts",
  "Description" : "Provides girls with leadership skills and the confidence to take challenges head on and to let them know that woman have a place in this world also",
  "Address" : "21 Montauk Ave Ste 203 New London, CT 06320",
  "Link" : "https://www.girlscouts.org/en/adults/volunteer.html "
};

var campNorwalk = {
  "Name" : "George Washington Carver Community Center",
  "Description" : "Community Center for children and Adults. They hold after school activities to help children improve their learning",
  "Address" : "7 Academy Street Norwalk, CT 06850",
  "Link" : "https://www.carvernorwalk.org/"
};

var campcoun = {
    "Bridgeport" : [campBridgeport, camp1Bridgeport],
    "Danbury" : "No responses matching search",
    "Glastonbury" : "No responses matching search",
    "Greenwich" : "No responses matching search",
    "Hartford" : campHartford,
    "Litchfield" : "No responses matching search",
    "Middletown" : "No responses matching search",
    "Haven" : campHaven,
    "London" : campLondon,
    "Norwalk" : campNorwalk,
    "Stamford" : "No responses matching search",
    "Waterbury" : "No responses matching search"
};
/////////////////////////////////////////////////////////////////////

var comBridgeport = {
  "Name" : "Service For Peace Inc.",
  "Description" : "Volunteers participate in ongoing community development programs throughout the world",
  "Address" : "360 Fairfield Ave Ste 206, Bridgeport CT, 06604",
  "Link" : "http://www.serviceforpeace.org/"
};

var com1Bridgeport = {
  "Name" : "American Red Cross",
  "Description" : "Provide relief to victims of disaster and help people prevent prepare for, and respond to emergencies",
  "Address" : "158 Brooklawn Ave, Bridgeport CT, 06604",
  "Link" : "http://www.redcross.org/"
};

var comDanbury = {
  "Name" : "Housatonic Habitat for Humanity",
  "Description" : "Provide affordable homes built by volunteers with materials giften by local businesses",
  "Address" : "51 Austin St, Danbury CT, 06810",
  "Link" : "http://housatonichabitat.org/about/what-we-do/"
};

var com1Danbury = {
  "Name" : "American Red Cross",
  "Description" : "Provide relief to victims of disaster and help people prevent prepare for, and respond to emergencies",
  "Address" : "2 Terrace Pl, Danbury CT, 06810",
  "Link" : "http://www.redcross.org/"
};

var com2Danbury = {
  "Name" : "The Salvation Army Family Store and Donation Center",
  "Description" : "Help disaster survivors, cure hunger, overcome poverty, serve the LGBTQ community, provide shelter, fight human trafficking, stop domestic abuse, equip families, teach kids, empower the arts, assist the unemployed, combat addiction, love the elderly, serve veterans, share god\'s love, and meet the greatest need",
  "Address" : "129 Main St, Danbury CT, 06810",
  "Link" : "https://www.salvationarmyusa.org/usn/"
};


var comGlastonbury= {
  "Name" : "YMCA",
  "Address" : "95 Oakwood Drive, Glastonbury CT, 06033",
  "Description" : "You can help by choosing from the options of being a coach, volunteering, and doing community service",
  "Link" : "http://www.ghymca.org/index.cfm"
};

var com1Glastonbury = {
  "Name" : "Youth and Family Services",
  "Description" : "Glastonbury youth and family services is a town agency devoted to programs and services that respond to the needs of glastonbury youth and their family",
  "Address" : "321 Hubbard Street, Glastonbury CT, 06033",
  "Link" : "http://www.glastonbury-ct.gov/departments/department-directory-l-z/youth-and-family-services#ad-image-2"
};

var comGreenwich = {
  "Name" : "American Red Cross",
  "Description" : "Blood donations",
  "Address" : "99 Indian Field Rd, Greenwich",
  "Link" : "http://www.redcross.org/"
}

var comHartford = {
  "Name" : "Stitch A Memory Bear",
  "Description" : "Volunteer to sew a memory bear for someone who has lost a relative",
  "Address" : "Locations throughout CT",
  "Link" : "https://www.vitas.com/about-us/hospice-volunteers/hearts-and-hands-help-vitas-hospice-families"
};

var comLitchfield = {
  "Name" : "Litchfield Community Center",
  "Description" : "The Litchfield Community Center is a non-profit organization serving Litchfield and the surrounding communities of Connecticut since 2000, offering daily creative, intellectual and recreational programs for all ages. Residents and non-residents are welcome to join us",
  "Address" : "421 Bantam Rd, Litchfield, CT 06759",
  "Link" : "https://www.thecommunitycenter.org/"
};
var comMiddletown = {
  "Name" : "Artists For World Peace",
  "Description" : "To create opportunities for artistic expression that fosters world peace and raise funds to benefit humanitarian causes",
  "Address" : "377 Ridge Rd, Middletown CT, 06457",
  "Link" : "https://www.artistsforworldpeace.org/"
};

var com1Middletown = {
  "Name" : "Gilead Community Services",
  "Description" : "Mission is to provide a broad range of high quality health care and recovery support services in the home and community to improve mental health, physical well-being, independence and community integration for the individuals we serve",
  "Address" : "222 Main Street Extension P.O. Box 1000, Middletown CT, 06457",
  "Link" : "http://gileadcs.org/"
};
var com2Middletown = {
  "Name" : "Greater Middletown Chorale Inc.",
  "Description" : "Perform community choral concerts with volunteers, donors, and a support system",
  "Address" : "190 Court St, Middletown CT, 06457",
  "Link" : "http://gmchorale.org/"
};

var comHaven = {
  "Name" : "Community Soup Kitchen",
  "Description" : "Services meals all day and supplies food to the homeless",
  "Address" : "84 Broadway New Haven CT 06511",
  "Link" : "http://www.csknewhaven.org/"
};

var comLondon = {
  "Name" : "Homeless Hospitality Center",
  "Description" : "Volunteer opportunities that take as little as a few hours per month. You can help with a one-time project or come every week. They serve food, clean parks, etc.",
  "Address" : "325 Huntington St New London, CT 06320",
  "Link" : "https://www.nlhhc.org/volunteer"
};

var comNorwalk = {
  "Name" : "Human Services Council",
  "Description" : "They deal with all services that pertain to humans. Things such as food, clothing school supplies and they also deal with violence issues",
  "Address" : "1 Park St, 2nd Floor, Norwalk, CT 06851",
  "Link" : "https://hscct.org/"
};

var comStamford = {
  "Name" : "The Jewish Community Center",
  "Description" : "The Stamford JCC is a cultural, educational and recreational center, offering exceptional programs, classes and special events designed to enrich the mind, body and spirit. We are driven by the Jewish values of welcoming guests, kindness, respect, and communal responsibility, and we warmly welcome people of all ages, faiths, ethnicities and backgrounds",
  "Address" : "1035 Newfield Avenue  Stamford, CT 06905",
  "Link" : "http://www.stamfordjcc.org/"
};

var comWaterbury = {
  "Name" : "Waterbury Fire Department",
  "Description" : "We are a committed, modern fire department that prides itself on a well-trained workforce that stands ready to immediately respond, assist and aid the public in any way possible.  Our services not only contribute to the safety of the public but also contribute to the stability of our city",
  "Address" : "236 Grand Street, 4th floor Waterbury, CT 06702",
  "Link" : "http://www.waterburyct.org/fire"
};

var communityserv = {
    "Bridgeport" : [comBridgeport, com1Bridgeport],
    "Danbury" : [comDanbury, com1Danbury, com2Danbury],
    "Glastonbury" : [comGlastonbury, com1Glastonbury],
    "Greenwich" : comGreenwich,
    "Hartford" : comHartford,
    "Litchfield" : comLitchfield,
    "Middletown" : [comMiddletown, com1Middletown],
    "Haven" : comHaven,
    "London" : comLondon,
    "Norwalk" : comNorwalk,
    "Stamford" : comStamford,
    "Waterbury" : comWaterbury
};
/////////////////////////////////////////////////////////////////
var teachBridgeport = {
  "Name" : "Daniel Trust Foundation",
  "Description" : "Invests in and supports the educational and professional goals of low income students",
  "Address" : "285 Fairfield Avenue, Bridgeport CT, 06604",
  "Link" : "https://www.danieltrustfoundation.org/"
};

var teach1Bridgeport = {
  "Name" : "Mercy learning center",
  "Description" : "Provides basic learning and literacy to low income women",
  "Address" : "637 Park Ave, Bridgeport CT, 06604 ",
  "Link" : "http://www.mercylearningcenter.org/"
};

var teachDanbury = {
  "Name" : "The Salvation Army Family Store and Donation Center",
  "Description" : "Help disaster survivors, cure hunger, overcome poverty, serve the LGBTQ community, provide shelter, fight human trafficking, stop domestic abuse, equip families, teach kids, empower the arts, assist the unemployed, combat addiction, love the elderly, serve veterans, share god\'s love, and meet the greatest need",
  "Address" : "129 Main St, Danbury CT, 06810",
  "Link" : "https://www.salvationarmyusa.org/usn/"
};

var teachGlastonbury = {
  "Name" : "Children\'s Advancement Fund",
  "Description" : "A nonprofit organization, supports children with special needs and their families in connecticut by facilitating services such as occupational, physical, and speech/language therapy",
  "Address" : "1062 Glastonbury CT 06033 USA",
  "Link" : "https://www.facebook.com/childrensadvancementfund/"
};
var teachLitchfield = {
  "Name" : "Greenwoods Counseling Referrals",
  "Description" : "We at Greenwoods know that quality mental healthcare can be very difficult to find, especially for those who are in crisis and have no idea where to turn",
  "Address" : "25 S St Litchfield, CT 06759",
  "Link" : "http://www.greenwoodsreferrals.org/"
};

var teachHartford = {
  "Name" : "The Salvation Army Family Store and Donation Center",
  "Description" : "Help disaster survivors, cure hunger, overcome poverty, serve the LGBTQ community, provide shelter, fight human trafficking, stop domestic abuse, equip families, teach kids, empower the arts, assist the unemployed, combat addiction, love the elderly, serve veterans, share god\'s love, and meet the greatest need",
  "Address" : "121/123 Sigourney Street Hartford,CT",
  "Link" : "https://www.salvationarmyusa.org/usn/"
};

var teachHaven = {
  "Name" : "All Our Kin",
  "Description" : "It supports kids and gives them a fair shot at life. Makes that each kid learns the value of life and the value of education",
  "Address" : "414 A Chapel St, New Haven, CT 06511",
  "Link" : "https://greatnonprofits.org/org/all-our-kin-inc"
};
var teachWaterbury = {
  "Name" : "Waterbury Youth Services",
  "Description" : "Guiding youth to discover their unique talents and potential for success",
  "Address" : "83 Prospect Street, Waterbury CT  06702",
  "Link" : "http://waterburyyouthservices.org/"
};

var teaching = {
    "Bridgeport" : [teachBridgeport, teach1Bridgeport],
    "Danbury" : teachDanbury,
    "Glastonbury" : teachGlastonbury,
    "Greenwich" : "No responses matching search",
    "Hartford" : teachHartford,
    "Litchfield" : teachLitchfield,
    "Middletown" : "No responses matching search",
    "Haven" : teachHaven,
    "London" : "No responses matching search",
    "Norwalk" : "No responses matching search",
    "Stamford" : "No responses matching search",
    "Waterbury" : teachWaterbury
};

///////////////////////////////////////////////////////////////////////
var locationKeys = ["Name","Address","Description","Link"];
var currAddress;
var listed;
//creates result string
function checkIfInListed(serviceDictionary){
  console.log("name is" + serviceDictionary.Name)
  for (var i = 0 ; i<listed.length; i++){
    if (listed[i].Name==serviceDictionary.Name){
      return true
    }
  }
  return false;
}

function returnLocationDict(dict){
  var str = "";
  for (var key in dict){
    //dict["Ass"]
    str += "<br>" + "<strong>" + key + ": </strong>";
    if (key == "Link") {
      str += "<a target='_blank' href=" + dict[key] + ">" + dict[key] + "</a></br>"
    } else  {
      str += dict[key] + "<br>"
    }
    console.log(str)
  }
  //fill the string
  if (str == "No responses matching search") {
    return "";
  } else {
    return str;
  }
}
var townList = ["Bridgeport", "Danbury", "Glastonbury", "Greenwich", "Hartford", "Litchfield", "Middletown", "Haven", "London", "Norwalk", "Stamford", "Waterbury"]
function returnServiceDict(dict, town){
  var str = "";
  var end;
  var listOfTowns;
  if (town == "AllLoc"){
    listOfTowns = townList;
    end = townList.length;
  } else {
    listOfTowns = [town]
    end = 1;
  }
  for (var j = 0; j < end; j++){
    town = listOfTowns[j]
    var type = typeof dict[town];
    console.log(type)
    if (type == "string"){
      if (dict[town] != "No responses matching search"){
        str = str + dict[town];
        buildLocationQuery(town, address, title)
      }
    } else if (type == "object") {
      if (dict[town].Address == null){
        for (var i = 0; i<dict[town].length; i++){
          console.log(dict[town][i].Address)

          if (returnLocationDict(dict[town][i]) != "No responses matching search") {
            console.log("listed?" + checkIfInListed(dict[town]))
            console.log(listed)
            if (checkIfInListed(dict[town]) == false){
              console.log("building string")
              str = str + "<br><br>" + returnLocationDict(dict[town][i]) + "</br></br>";
              buildAddressQuery(dict[town][i].Address, dict[town][i].Name);
              listed.push(dict[town])
            }
          }

        }
      } else {
        console.log("listed? "+checkIfInListed(dict[town]))
        console.log(listed);
        if (checkIfInListed(dict[town]) == false){
          console.log("building string")
          str = str + "<br><br>" + returnLocationDict(dict[town]) + "</br></br>";
          buildAddressQuery(dict[town].Address, dict[town].Name)
          listed.push(dict[town])
        }
      }
    }
  }
  if (str == "" && allServ_selected == false){
    str = "<br><br>" + "No responses matching search" + "</br></br>";
  }
  return str;
}
function getQueryVariable(variable)
{
       var query = window.location.search.substring(1);
       var vars = query.split("&");
       for (var i=0;i<vars.length;i++) {
               var pair = vars[i].split("=");
               if(pair[0] == variable){return pair[1];}
       }
       return(false);
}
//////////////////////////////////////////////////////////////
var allServ_selected = false;
function showResults() {
  console.log("showing results")
  listed = [];
  var loc = getQueryVariable("location");
  var serv = getQueryVariable("services")
  var dict;
  var serviceList = [animals, people, oneday, campcoun, communityserv, teaching]

  if (serv == "Animals") {
    dict = animals;
  }
  else if (serv == "People") {
    dict = people;
  }
  else if (serv == "Oneday") {
    dict = oneday;
  }
  else if (serv == "Campcoun") {
    dict = campcoun;
  }
  else if (serv == "Communityserv") {
    dict = communityserv;
  }
  else if (serv == "Teaching") {
    dict = teaching;
  }
  else if (serv == "AllServ") {
    allServ_selected = true;
    var text = ""
    for (var i=0; i<serviceList.length; i++){
      var tempResult = returnServiceDict(serviceList[i],loc)
      console.log("gen "+tempResult)
      if (tempResult !== "No responses matching search"){
        console.log("there was something")
        text = text + tempResult
      }
    }
    if (text == ""){
      text = "<br><br>No responses matching search</br></br>"
    }
    document.getElementById("resultText").innerHTML=text;
    return;
  }

  console.log(dict)
  var text = returnServiceDict(dict,loc);
  document.getElementById("resultText").innerHTML=text;
};


//get coordinates
// import JSON
var key =  "AjF9Y3TNv8qksMyX9-jcq5h6yUIHx0FQVbNmEGBOUZzbMNqQROaEy67ug_UP-8xz"
//returns JSON text
function GET(query) {
  var request = new XMLHttpRequest();
  request.open('GET',query, false);
  request.send();

  return JSON.parse(request.responseText);
}

function buildAddressQuery(fulladdress, name){
  var address = fulladdress.replace(/ /g,"%20");
  var query = "https://dev.virtualearth.net/REST/v1/Locations?q="+address+"&key="+key
  pin(query, name, fulladdress)
}

function buildLocationQuery(fulllocation, title){
  var location = fulllocation.replace(/ /g,"%20");
  var query = "https://dev.virtualearth.net/REST/v1/Locations?locality="+location+"&key="+key
  pin(query, name, fulllocation)
}

function pin(query, title, name){
  var data = GET(query)

  var lat = data.resourceSets[0].resources[0].point.coordinates[0];
  console.log(lat)

  var long = data.resourceSets[0].resources[0].point.coordinates[1];
  console.log(long)

  var marker = L.marker([lat, long],{title: title + ". " + "Address: " + name}).addTo(mymap);
}

console.log("on page")
showResults();
