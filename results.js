anDanbury = {
  "Name" : "Tails of Courage",
  "Description" : "Dog walkers, foster homes, volunteers at shelters, volunteers for adoption events, spreading the word, clean up, transportation",
  "Address" : "39 Smith St, Danbury CT, 06810",
  "Link" : "https://tailsofcourage.org/fostervolunteering/"
};

var animals = {
    "Bridgeport" : "No responses matching search",
    "Danbury" : anDanbury,
    "Glastonbury" : "No responses matching search",
    "Greenwich" : "No responses matching search",
    "Hartford" : "No responses matching search",
    "Litchfield" : "No responses matching search",
    "Middletown" : "No responses matching search",
    "Haven" : "No responses matching search",
    "London" : "No responses matching search",
    "Norwalk" : "No responses matching search",
    "Stamford" : "No responses matching search",
    "Waterbury" : "No responses matching search"
};
/////////////////////////////////////////////////////////////////////////////////////
var pplBridgeport = {
  "Name" : "Daniel trust foundation",
  "Description" : "Invests in and supports low income students’ educational and professional goals",
  "Address" : "285 Fairfield Avenue, Bridgeport CT, 06604",
  "Link" : "https://www.danieltrustfoundation.org/"
};

var pplDanbury = {
  "Name" : "The Salvation Army Family Store and Donation Center",
  "Description" : "Help disaster survivors, cure hunger, overcome poverty, serve the LGBTQ community, provide shelter, fight human trafficking, stop domestic abuse, equip families, teach kids, empower the arts, assist the unemployed, combat addiction, love the elderly, serve veterans, share god's love, and meet the greatest need",
  "Address" : "129 Main St, Danbury CT, 06810",
  "Link" : "https://www.salvationarmyusa.org/usn/"
};
var pplGlastonbury = {
  "Name" : "Youth and Family Services",
  "Description" : "Glastonbury youth and family services is a town agency devoted to programs and services that respond to the needs of glastonbury youth and their family",
  "Address" : "321 Hubbard Street, Glastonbury CT, 06033",
  "Link" : "http://www.glastonbury-ct.gov/departments/department-directory-l-z/youth-and-family-services#ad-image-2"
};
var ppl1Glastonbury = {
  "Name" : "Glastonbury Food Bank",
  "Description" : "Provide educational, creative, and social benefits for all children with particular reference to children with special needs",
  "Address" : "2155 Main St, Glastonbury CT",
  "Link" : "http://www.childrensworldcharity.org/"
};
var ppl2Glastonbury= {
  "Name" : "YMCA",
  "Address" : "95 Oakwood Drive, Glastonbury CT, 06033",
  "Description" : "You can help by choosing from the options of being a coach, volunteering, and doing community service",
  "Link" : "http://www.ghymca.org/index.cfm"
};
var ppl3Glastonbury = {
  "Name" : "Children Advancement Fund",
  "Description" : "A nonprofit organization, supports children with special needs and their families in connecticut by facilitating services such as occupational, physical, and speech/language therapy",
  "Address" : "1062 Glastonbury CT 06033 USA ",
  "Link" : "https://www.facebook.com/childrensadvancementfund/"
};

var pplHartford = {
  "Name" : "Connecticut Children’s Medical Center",
  "Description" : "Connecticut Children’s Medical Center is dedicated to improving the physical and emotional health of children through family-centered care, research, education and advocacy. They embrace discovery, teamwork, integrity and excellence in all that we do. They are making children in Connecticut the healthiest in the country",
  "Address" : "282 Washington St, Hartford, CT 06106",
  "Link" : "https://www.connecticutchildrens.org/about-us/mission/"
};

var pplHaven = {
  "Name" : "Cents of Relief",
  "Description" : "This non-profit help people in vulnerable situations especially women in prostitution. They provide healthcare for their kids. They also help in the effort of stopping human trafficking",
  "Address" : "109 Church Street, Apt 202 New Haven CT 06510 USA",
  "Link" : "https://greatnonprofits.org/org/centsofrelief"
};
var pplLondon = {
  "Name" : "Birthright- Israel",
  "Description" : "Birthright guiding principle It is the right of every pregnant woman to give birth and the right of every child to be born. Birthright offers the alternative to abortion. Birthright is pro-life. Birthright is non-profit, interdenominational, and non-political. Help make a difference in a mother's life as she prepares for the birth of her baby",
  "Address" : "26 Phillips St, New London, CT 06901",
  "Link" : "https://www.birthrightisrael.com/"
};
var pplNorwalk = {
  "Name" : "Person 2 Person",
  "Description" : "Person 2 Person is an organization that helps to less fortunate. They have events such as food pantries,P2P on wheels, and food drive",
  "Address" : "76 S Main St, Norwalk, CT 06854",
  "Link" : "https://p2phelps.org/volunteers/#volunteer-programs"
};
var pplStamford = {
  "Name" : "SunRise Senior Living",
  "Description" : "A nursing home for the elderly and also a its a rehab center for the injured",
  "Address" : "251 Turn of River Road  Stamford  CT  06905",
  "Link" : "https://www.sunriseseniorliving.com/"
};
var ppl1Stamford = {
  "Name" : "At Risk Youth",
  "Description" : "Mentors needed to guide at risk youth",
  "Address" : "1 Hospital Plaza, Stamford, CT 06904 ",
  "Link" : "https://www.stamfordhealth.org/about/volunteering/"
};

var ppl2Stamford = {
  "Name" : "Birthright- Israel",
  "Description" : "Birthright guiding principle It is the right of every pregnant woman to give birth and the right of every child to be born. Birthright offers the alternative to abortion. Birthright is pro-life. Birthright is non-profit, interdenominational, and non-political. Help make a difference in a mother's life as she prepares for the birth of her baby",
  "Address" : "388 Summer St, Stamford, CT 06901",
  "Link" : "https://www.birthrightisrael.com/"
};


var people = {
    "Bridgeport" : pplBridgeport,
    "Danbury" : pplDanbury,
    "Glastonbury" : [pplGlastonbury, ppl1Glastonbury, ppl2Glastonbury, ppl3Glastonbury],
    "Greenwich" : "No responses matching search",
    "Hartford" : pplHartford,
    "Litchfield" : "No responses matching search",
    "Middletown" : "No responses matching search",
    "Haven" : pplHaven,
    "London" : pplLondon,
    "Norwalk" : pplNorwalk,
    "Stamford" : [pplStamford, ppl1Stamford],
    "Waterbury" : "No responses matching search"
};
////////////////////////////////////////////////////////////

var oneDanbury = {
  "Name" : "Tails of Courage",
  "Description" : "Dog walkers, foster homes, volunteers at shelters, volunteers for adoption events, spreading the word, clean up, transportation",
  "Address" : "39 Smith St, Danbury CT, 06810",
  "Link" : "https://tailsofcourage.org/fostervolunteering/"
};

var oneGlastonbury = {
  "Name" : "Glastonbury Food Bank",
  "Description" : "Provide educational, creative, and social benefits for all children with particular reference to children with special needs",
  "Address" : "2155 Main St, Glastonbury CT",
  "Link" : "http://www.childrensworldcharity.org/"
};

var oneday = {
    "Bridgeport" : "No responses matching search",
    "Danbury" : oneDanbury,
    "Glastonbury" : oneGlastonbury,
    "Greenwich" : "No responses matching search",
    "Hartford" : "No responses matching search",
    "Litchfield" : "No responses matching search",
    "Middletown" : "No responses matching search",
    "Haven" : "No responses matching search",
    "London" : "No responses matching search",
    "Norwalk" : "No responses matching search",
    "Stamford" : "No responses matching search",
    "Waterbury" : "No responses matching search"
};

/////////////////////////////////////////////////////////////
var campBridgeport = {
  "Name" : "Daniel Trust Foundation",
  "Description" : "Invests in and supports the educational and professional goals of low income students",
  "Address" : "285 Fairfield Avenue, Bridgeport CT, 06604",
  "Link" : "https://www.danieltrustfoundation.org/"
};

var camp1Bridgeport = {
  "Name" : "Service For Peace Inc.",
  "Description" : "Volunteers participate in ongoing community development programs throughout the world",
  "Address" : "360 Fairfield Ave Ste 206, Bridgeport CT, 06604",
  "Link" : "http://www.serviceforpeace.org/"
};

var campHartford = {
  "Name" : "Girl Scouts",
  "Description" : "Provides girls with leadership skills and the confidence to take challenges head on and to let them know that woman have a place in this world also",
  "Address" : "340 Washington St, Hartford, CT 06106",
  "Link" : "https://www.girlscouts.org/en/adults/volunteer.html"
};

var campHaven = {
  "Name" : "Solar Youth",
  "Description" : "Solar Youth provides opportunities for young people to develop a positive sense of self and connection and commitment to others through programs that incorporate environmental exploration, leadership and community service",
  "Address" : "53 Wayfarer St New Haven CT 06515 USA",
  "Link" : "https://greatnonprofits.org/org/solar-youth-inc"
};

var campLondon = {
  "Name" : "Girl Scouts",
  "Description" : "Provides girls with leadership skills and the confidence to take challenges head on and to let them know that woman have a place in this world also",
  "Address" : "21 Montauk Ave Ste 203 New London, CT 06320",
  "Link" : "https://www.girlscouts.org/en/adults/volunteer.html "
};

var campNorwalk = {
  "Name" : "George Washington Carver Community Center",
  "Description" : "Community Center for children and Adults. They hold after school activities to help children improve their learning",
  "Address" : "7 Academy Street Norwalk, CT 06850",
  "Link" : "https://www.carvernorwalk.org/"
};

var campcoun = {
    "Bridgeport" : [campBridgeport, camp1Bridgeport],
    "Danbury" : "No responses matching search",
    "Glastonbury" : "No responses matching search",
    "Greenwich" : "No responses matching search",
    "Hartford" : campHartford,
    "Litchfield" : "No responses matching search",
    "Middletown" : "No responses matching search",
    "Haven" : campHaven,
    "London" : campLondon,
    "Norwalk" : campNorwalk,
    "Stamford" : "No responses matching search",
    "Waterbury" : "No responses matching search"
};
/////////////////////////////////////////////////////////////////////

var comBridgeport = {
  "Name" : "Service For Peace Inc.",
  "Description" : "Volunteers participate in ongoing community development programs throughout the world",
  "Address" : "360 Fairfield Ave Ste 206, Bridgeport CT, 06604",
  "Link" : "http://www.serviceforpeace.org/"
};

var com1Bridgeport = {
  "Name" : "American Red Cross",
  "Description" : "Provide relief to victims of disaster and help people prevent prepare for, and respond to emergencies",
  "Address" : "158 Brooklawn Ave, Bridgeport CT, 06604",
  "Link" : "http://www.redcross.org/"
};

var comDanbury = {
  "Name" : "Housatonic Habitat for Humanity",
  "Description" : "Provide affordable homes built by volunteers with materials giften by local businesses",
  "Address" : "51 Austin St, Danbury CT, 06810",
  "Link" : "http://housatonichabitat.org/about/what-we-do/"
};

var com1Danbury = {
  "Name" : "American Red Cross",
  "Description" : "Provide relief to victims of disaster and help people prevent prepare for, and respond to emergencies",
  "Address" : "2 Terrace Pl, Danbury CT, 06810",
  "Link" : "http://www.redcross.org/"
};

var com2Danbury = {
  "Name" : "The Salvation Army Family Store and Donation Center",
  "Description" : "Help disaster survivors, cure hunger, overcome poverty, serve the LGBTQ community, provide shelter, fight human trafficking, stop domestic abuse, equip families, teach kids, empower the arts, assist the unemployed, combat addiction, love the elderly, serve veterans, share god's love, and meet the greatest need",
  "Address" : "129 Main St, Danbury CT, 06810",
  "Link" : "https://www.salvationarmyusa.org/usn/"
};


var comGlastonbury= {
  "Name" : "YMCA",
  "Address" : "95 Oakwood Drive, Glastonbury CT, 06033",
  "Description" : "You can help by choosing from the options of being a coach, volunteering, and doing community service",
  "Link" : "http://www.ghymca.org/index.cfm"
};

var com1Glastonbury = {
  "Name" : "Youth and Family Services",
  "Description" : "Glastonbury youth and family services is a town agency devoted to programs and services that respond to the needs of glastonbury youth and their family",
  "Address" : "321 Hubbard Street, Glastonbury CT, 06033",
  "Link" : "http://www.glastonbury-ct.gov/departments/department-directory-l-z/youth-and-family-services#ad-image-2"
};

var comGreenwich = {
  "Name" : "American Red Cross",
  "Description" : "Blood donations",
  "Address" : "99 Indian Field Rd, Greenwich",
  "Link" : "http://www.redcross.org/"
}

var comHartford = {
  "Name" : "Stitch A Memory Bear",
  "Description" : "Volunteer to sew a memory bear for someone who has lost a relative",
  "Address" : "Locations throughout CT",
  "Link" : "https://www.vitas.com/about-us/hospice-volunteers/hearts-and-hands-help-vitas-hospice-families"
};

var comHaven = {
  "Name" : "Community Soup Kitchen",
  "Description" : "Services meals all day and supplies food to the homeless",
  "Address" : "84 Broadway New Haven CT 06511",
  "Link" : "http://www.csknewhaven.org/"
};

var comLondon = {
  "Name" : "Homeless Hospitality Center",
  "Description" : "Volunteer opportunities that take as little as a few hours per month. You can help with a one-time project or come every week. They serve food, clean parks, etc.",
  "Address" : "325 Huntington St New London, CT 06320",
  "Link" : "https://www.nlhhc.org/volunteer"
};

var comNorwalk = {
  "Name" : "Human Services Council",
  "Description" : "They deal with all services that pertain to humans. Things such as food, clothing school supplies and they also deal with violence issues",
  "Address" : "1 Park St, 2nd Floor, Norwalk, CT 06851",
  "Link" : "https://hscct.org/"
};

var comStamford = {
  "Name" : "The Jewish Community Center",
  "Description" : "The Stamford JCC is a cultural, educational and recreational center, offering exceptional programs, classes and special events designed to enrich the mind, body and spirit. We are driven by the Jewish values of welcoming guests, kindness, respect, and communal responsibility, and we warmly welcome people of all ages, faiths, ethnicities and backgrounds",
  "Address" : "1035 Newfield Avenue  Stamford, CT 06905",
  "Link" : "http://www.stamfordjcc.org/"
};

var communityserv = {
    "Bridgeport" : [comBridgeport, com1Bridgeport],
    "Danbury" : [comDanbury, com1Danbury, com2Danbury],
    "Glastonbury" : [comGlastonbury, com1Glastonbury],
    "Greenwich" : comGreenwich,
    "Hartford" : comHartford,
    "Litchfield" : "No responses matching search",
    "Middletown" : "No responses matching search",
    "Haven" : comHaven,
    "London" : comLondon,
    "Norwalk" : comNorwalk,
    "Stamford" : comStamford,
    "Waterbury" : "No responses matching search"
};
/////////////////////////////////////////////////////////////////
var teachBridgeport = {
  "Name" : "Daniel Trust Foundation",
  "Description" : "Invests in and supports the educational and professional goals of low income students",
  "Address" : "285 Fairfield Avenue, Bridgeport CT, 06604",
  "Link" : "https://www.danieltrustfoundation.org/"
};

var teach1Bridgeport = {
  "Name" : "Mercy learning center",
  "Description" : "Provides basic learning and literacy to low income women",
  "Address" : "637 Park Ave, Bridgeport CT, 06604 ",
  "Link" : "http://www.mercylearningcenter.org/"
};

var teachDanbury = {
  "Name" : "The Salvation Army Family Store and Donation Center",
  "Description" : "Help disaster survivors, cure hunger, overcome poverty, serve the LGBTQ community, provide shelter, fight human trafficking, stop domestic abuse, equip families, teach kids, empower the arts, assist the unemployed, combat addiction, love the elderly, serve veterans, share god's love, and meet the greatest need",
  "Address" : "129 Main St, Danbury CT, 06810",
  "Link" : "https://www.salvationarmyusa.org/usn/"
};

var teachGlastonbury = {
  "Name" : "Children’s Advancement Fund",
  "Description" : "A nonprofit organization, supports children with special needs and their families in connecticut by facilitating services such as occupational, physical, and speech/language therapy",
  "Address" : "1062 Glastonbury CT 06033 USA ",
  "Link" : "https://www.facebook.com/childrensadvancementfund/"
};

var teachHartford = {
  "Name" : "The Salvation Army Family Store and Donation Center",
  "Description" : "Help disaster survivors, cure hunger, overcome poverty, serve the LGBTQ community, provide shelter, fight human trafficking, stop domestic abuse, equip families, teach kids, empower the arts, assist the unemployed, combat addiction, love the elderly, serve veterans, share god's love, and meet the greatest need",
  "Address" : "121/123 Sigourney Street Hartford,CT",
  "Link" : "https://www.salvationarmyusa.org/usn/"
};

var teachHaven = {
  "Name" : "All Our Kin",
  "Description" : "It supports kids and gives them a fair shot at life. Makes that each kid learns the value of life and the value of education",
  "Address" : "414 A Chapel St, New Haven, CT 06511 ",
  "Link" : "https://greatnonprofits.org/org/all-our-kin-inc"
};

var teaching = {
    "Bridgeport" : [teachBridgeport, teach1Bridgeport],
    "Danbury" : teachDanbury,
    "Glastonbury" : teachGlastonbury,
    "Greenwich" : "No responses matching search",
    "Hartford" : teachHartford,
    "Litchfield" : "No responses matching search",
    "Middletown" : "No responses matching search",
    "Haven" : teachHaven,
    "London" : "No responses matching search",
    "Norwalk" : "No responses matching search",
    "Stamford" : "No responses matching search",
    "Waterbury" : "No responses matching search"
};

///////////////////////////////////////////////////////////////////////

var locationKeys = ["Name","Address","Description","Link"];

//creates result string
function returnLocationDict(dict){
  var str = "";
  for (var key in dict){
    str += "<br>" + "<strong>" + key + ": </strong>";
    if (key == "Link") {
      str += "<a target='_blank' href=" + dict[key] + ">" + dict[key] + "</a></br>"
    } else  {
      str += dict[key] + "<br>"
    }
    console.log(str)
  }
  //fill the string
  return str;
}
var townList = ["Bridgeport", "Danbury", "Glastonbury", "Greenwich", "Hartford", "Litchfield", "Middletown", "Haven", "London", "Norwalk", "Stamford", "Waterbury"]
function returnServiceDict(dict, town){
  var str;
  var end;
  var listOfTowns;
  if (town == "AllLoc"){
    listOfTowns = townList;
    end = townList.length;
  } else {
    listOfTowns = [town]
    end = 1;
  }
  for (var j = 0; j < end; j++){
    town = listOfTowns[j]
    var type = typeof dict[town];
    console.log(type)
    if (type == "string"){
      str = dict[town];
      buildLocationQuery(town)
    } else if (type == "object") {
      if (dict[town].Address == null){
        str = ""
        for (var i = 0; i<dict[town].length; i++){
          console.log(dict[town][i].Address)
          str = str + "<br><br>" + returnLocationDict(dict[town][i]) + "</br></br>";
          buildAddressQuery(dict[town][i].Address);
        }
        if (str == ""){
          str = "<br><br>" + "No responses matching search" + "</br></br>";
        }
      } else {
        str = returnLocationDict(dict[town]);
        buildAddressQuery(dict[town].Address)
      }
    }
  }
  return str;
}
function getQueryVariable(variable)
{
       var query = window.location.search.substring(1);
       var vars = query.split("&");
       for (var i=0;i<vars.length;i++) {
               var pair = vars[i].split("=");
               if(pair[0] == variable){return pair[1];}
       }
       return(false);
}
//////////////////////////////////////////////////////////////
function showResults() {
  var loc = getQueryVariable("location");
  var serv = getQueryVariable("services")
  var dict;
  var serviceList = [animals, people, oneday, campcoun, communityserv, teaching]

  if (serv == "Animals") {
    dict = animals;
  }
  else if (serv == "People") {
    dict = people;
  }
  else if (serv == "Oneday") {
    dict = oneday;
  }
  else if (serv == "Campcoun") {
    dict = campcoun;
  }
  else if (serv == "Communityserv") {
    dict = communityserv;
  }
  else if (serv == "Teaching") {
    dict = teaching;
  }
  else if (serv == "AllServ") {
    var text = ""
    for (var i=0; i<serviceList.length; i++){
      var tempResult = returnServiceDict(serviceList[i],loc)
      console.log("gen "+tempResult)
      if (tempResult != "No responses matching search"){
        console.log("there was something")
        text = text + tempResult
      }
    }
    if (text == ""){
      text = "<br><br>No responses matching search</br></br>"
    }
    document.getElementById("resultText").innerHTML=text;
    return;
  }

  console.log(dict)
  var text = returnServiceDict(dict,loc);
  document.getElementById("resultText").innerHTML=text;
};


//get coordinates
// import JSON
var key =  "AjF9Y3TNv8qksMyX9-jcq5h6yUIHx0FQVbNmEGBOUZzbMNqQROaEy67ug_UP-8xz"
//returns JSON text
function GET(query) {
  var request = new XMLHttpRequest();
  request.open('GET',query, false);
  request.send();

  return JSON.parse(request.responseText);
}

function buildAddressQuery(fulladdress){
  var address = fulladdress.replace(/ /g,"%20");
  var query = "http://dev.virtualearth.net/REST/v1/Locations?q="+address+"&key="+key
  pin(query)
}

function buildLocationQuery(fulllocation){
  var location = fulllocation.replace(/ /g,"%20");
  var query = "http://dev.virtualearth.net/REST/v1/Locations?locality="+location+"&key="+key
  pin(query)
}

function pin(query){
  var data = GET(query)

  var lat = data.resourceSets[0].resources[0].point.coordinates[0];
  console.log(lat)

  var long = data.resourceSets[0].resources[0].point.coordinates[1];
  console.log(long)

  var marker = L.marker([lat, long]).addTo(mymap);
}

/* alert("Ready State " + countryRequest.readyState);
alert("Status " + countryRequest.status);
alert("Response " + countryRequest.responseText); */
// var long = response[0].latlng[1];
// var lat = response[0].latlng[0];
// var location = ol.proj.fromLonLat([long, lat]);


showResults();
